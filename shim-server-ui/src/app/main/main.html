

<div class="container">

  <ng-include src="'app/navbar/navbar.html'"></ng-include>

  <accordion class="shim-list" close-others="false">

    <accordion-group panel-class="shim-panel" is-open="main.panelStates[shimName]" ng-repeat="(shimName, shim) in main.shims">
        <accordion-heading>
          <span class="glyphicon glyphicon-triangle-right"></span><h2>{{shimName}}</h2>
        </accordion-heading>
        <div class="details">
          <div class="row">

            <div class="col-sm-7">
              <h3>Shim configuration</h3>
                <div class="table-responsive">

                  <form name="main.configurationForm">

                    <table class="table configuration">
                      <thead>
                        <tr>
                          <th class="col-sm-2"></th>
                          <th class="col-sm-5"></th>
                          <th class="col-sm-5"></th>
                        </tr>
                      </thead>
                      <tbody>

                        <tr ng-repeat="setting in shim.configuration.settings">
                          <th scope="row">{{setting.label}}</th>
                          <td>

                            <input type="number" class="form-control input-sm" ng-model="shim.configuration.values[setting.settingId].value" ng-if="setting.type==='integer'" min="{{setting.min}}" max="{{setting.max}}" ng-pattern="main.patterns.integer" name="{{setting.settingId}}" ng-required="setting.required">

                            <!--  ui-validate=" 'main.validate(shim.configuration,setting)' " -->

                            <input type="number" class="form-control input-sm" ng-model="shim.configuration.values[setting.settingId].value" ng-if="setting.type==='float'" min="{{setting.min}}" max="{{setting.max}}" name="{{setting.settingId}}" ng-required="setting.required">

                            <input type="text" value="value" class="form-control input-sm" ng-model="shim.configuration.values[setting.settingId].value" ng-if="setting.type==='string'" ng-minlength="setting.minlength" ng-maxlength="setting.maxlength" name="{{setting.settingId}}" ng-required="setting.required">

                            <ui-select ng-model="shim.configuration.values[setting.settingId].value" ng-if="setting.type==='boolean'" name="{{setting.settingId}}" ng-required="setting.required">
                              <ui-select-match placeholder="--">
                                {{$select.selected}}
                              </ui-select-match>
                              <ui-select-choices repeat="option in main.validBooleanSettings">
                                <div ng-bind="main.booleanLabels[ option ]"></div>
                              </ui-select-choices>
                            </ui-select>

                            <div ng-messages="main.configurationForm[setting.settingId].$error" role="alert" class="form-validation-message">
                              <div ng-message="required">Value is required.</div>
                              <div ng-message="minlength">Value is too short.</div>
                              <div ng-message="maxlength">Value is too long.</div>
                              <div ng-message="min">Number must be &gt; {{setting.min}}</div>
                              <div ng-message="max">Number must be &lt; {{setting.max}}</div>
                              <div ng-message="number">Value must be a number</div>
                              <div ng-message="pattern">Number must be a{{setting.type=='integer'?'n':''}} {{setting.type}}</div>
                            </div>

                          </td>
                          <td class="description">
                            <span  ng-if="setting.description">
                              {{main.truncate(setting.description,70)}}
                              <span class="more" popover="{{setting.description}}" popover-trigger="mouseenter" ng-if="setting.description.length>70">more</span>
                            </span>
                          </td>
                        </tr>


                        <tr>
                          <td class="description save-config" colspan="3">
                            Changes will become active after they are saved.
                              <button type="button" class="btn btn-default btn-xs">save changes</button>
                          </td>
                        </tr>

                      </tbody>
                    </table>

                  </form>

              </div>
            </div>

            <div class="col-sm-5">

<!-- TODO: Add stats -->
<!--               <h3>Vendor API Statistics</h3>
                <div class="table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th class="col-sm-3"></th>
                        <th class="col-sm-7"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row" class="compact">Label</th>
                        <td class="compact">Information</td>
                      </tr>
                      <tr>
                        <th scope="row" class="compact">Another label</th>
                        <td class="compact">Information</td>
                      </tr>
                      <tr>
                        <th scope="row" class="compact">A very long label that has to break</th>
                        <td class="compact">Information</td>
                      </tr>
                      <tr>
                        <th scope="row" class="compact">Another label</th>
                        <td class="compact">Information</td>
                      </tr>
                    </tbody>
                </table>
              </div>
 -->

              <h3>Supported schemas</h3>
                <div class="table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th class="col-sm-12"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="compact flat-list">
                          <div ng-repeat="schema in shim.schemas">{{schema.namespace}}:{{schema.name}}:{{schema.version}}</div>
                        </td>
                      </tr>
                    </tbody>
                </table>
              </div>
            </div>

          </div>
        </div>
    </accordion-group>

  </accordion>

</div>

